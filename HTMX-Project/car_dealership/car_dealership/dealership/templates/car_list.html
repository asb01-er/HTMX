{% extends 'base.html' %}
{% block content %}
<div class="max-w-5xl mx-auto mt-16 p-6">
  <h2 class="text-3xl font-bold mb-6 text-center">Available Cars</h2>

  {% if user.profile.role == 'manager' %}
  <div class="mb-6 text-center">
    <a href="{% url 'car_create' %}" class="btn btn-warning px-6 py-3 font-semibold hover:btn-accent transition-colors duration-300">
      Add New Car
    </a>
  </div>
  {% endif %}

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for car in cars %}
    <div class="bg-base-100 shadow-lg rounded-xl p-4 flex flex-col items-center">
      {% if car.image %}
      <img src="{{ car.image.url }}" alt="Car Image" class="w-48 h-32 object-cover rounded-lg mb-4 shadow-md">
      {% else %}
      <div class="w-48 h-32 bg-gray-200 flex items-center justify-center rounded-lg mb-4">
        No Image
      </div>
      {% endif %}

      <h3 class="text-xl font-bold text-center mb-2">{{ car.make }} {{ car.model }}</h3>
      <p class="text-gray-600 mb-2">Year: {{ car.year }}</p>

      {% if car.assigned_to %}
      <p class="text-sm text-gray-500 mb-2">Assigned to: {{ car.assigned_to.user.username }}</p>
      {% endif %}

      {% if user.profile.role == 'manager' %}
      <button 
        hx-get="{% url 'assign_car' car.id %}" 
        hx-target="#modal" 
        hx-swap="innerHTML"
        class="btn btn-accent px-4 py-2 font-semibold hover:btn-secondary transition-colors duration-300"
      >
        Assign
      </button>
      {% endif %}
    </div>
    {% empty %}
    <p class="text-center col-span-full">No cars available.</p>
    {% endfor %}
  </div>

  <div id="modal" class="mt-6"></div>
</div>
{% endblock %}
